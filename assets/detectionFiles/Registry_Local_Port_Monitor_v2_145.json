{
    "Detection Name": "Registry Local Port Monitor",
    "Description": "Investigating Registry Local Port Monitor attack on macOS. Analyzing object modifications in the registry.",
    "Annotations": [
        {
            "CVE": ""
        },
        {
            "Technique": "T1037-Boot or Logon Initialization Scripts"
        },
        {
            "Sub-Technique": "T1037.005-Boot or Logon Initialization Scripts: Startup Items"
        },
        {
            "Tactic": "Persistence, Privilege Escalation"
        },
        {
            "D3FEND": [
                {
                    "D3FEND": "D3-OSM",
                    "URL": "https://d3fend.mitre.org/technique/d3f:OperatingSystemMonitoring/"
                },
                {
                    "D3FEND": "D3-SICA",
                    "URL": "https://d3fend.mitre.org/technique/d3f:SystemInitConfigAnalysis/"
                },
                {
                    "D3FEND": "D3-PH",
                    "URL": "https://d3fend.mitre.org/technique/d3f:PlatformHardening/"
                },
                {
                    "D3FEND": "D3-PM",
                    "URL": "https://d3fend.mitre.org/technique/d3f:PlatformMonitoring/"
                }
            ]
        },
        {
            "Platform": [
                "macOS"
            ]
        },
        {
            "Group": []
        },
        {
            "Campaign": []
        },
        {
            "Software": [
                {
                    "Software": "jRAT (S0283)",
                    "URL": "https://attack.mitre.org/software/S0283"
                }
            ]
        },
        {
            "NIST": [
                {
                    "NIST": "DE.CM",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/de-cm"
                },
                {
                    "NIST": "PR.DS",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-ds"
                },
                {
                    "NIST": "PR.IR",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-ir"
                },
                {
                    "NIST": "ID.IM",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/id/id-im"
                },
                {
                    "NIST": "DE.AE",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/de-ae"
                },
                {
                    "NIST": "ID.RA",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/id/id-ra"
                },
                {
                    "NIST": "PR.AA",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-aa"
                },
                {
                    "NIST": "PR.PS",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-ps"
                }
            ]
        },
        {
            "CIS": [
                {
                    "CIS": "CIS 4",
                    "URL": "https://www.cisecurity.org/controls/secure-configuration-of-enterprise-assets-and-software"
                }
            ]
        },
        {
            "Agent": []
        }
    ],
    "Type": "TTP (Tactics, Techniques, and Procedures)",
    "Logging Required": [],
    "Recommended Actions": [],
    "Considerations": [
        "During regular system maintenance or updates, legitimate changes to the registry may occur, including modifications to the 'SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors' key. These changes are expected and should be verified with the IT team before raising an alert.",
        "When new printer drivers are installed, they may modify registry keys related to print monitors. This activity is normal and should be cross-checked with recent installation logs or user activity before confirming it as an attack.",
        "Automated tools used for system configuration and management might modify registry settings as part of their operations. Ensure that such tools are accounted for and their activities are documented to avoid false positives."
    ],
    "Mitigation": [
        {
            "Mitigation": "Restrict File and Directory Permissions (M1022)",
            "URL": "https://attack.mitre.org/mitigations/M1022"
        }
    ],
    "References": [
        "MITRE. (n.d.). MITRE ATT&CK. https://attack.mitre.org/",
        "Center for Internet Security (CIS). (n.d.). CISecurity homepage. https://www.cisecurity.org/",
        "MITRE. (n.d.). MITRE D3FEND. https://d3fend.mitre.org/",
        "National Institute of Standards and Technology. (n.d.). Cybersecurity framework. https://www.nist.gov/cyberframework"
    ]
}