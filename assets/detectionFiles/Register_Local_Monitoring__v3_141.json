{
    "Detection Name": "Register Local Monitoring",
    "Description": "Investigating Register Local Monitoring attack on macOS using DQL queries.",
    "Annotations": [
        {
            "CVE": ""
        },
        {
            "Technique": "T1037-Boot or Logon Initialization Scripts"
        },
        {
            "Sub-Technique": "T1037.005-Boot or Logon Initialization Scripts: Startup Items"
        },
        {
            "Tactic": "Persistence, Privilege Escalation"
        },
        {
            "D3FEND": [
                {
                    "D3FEND": "D3-OSM",
                    "URL": "https://d3fend.mitre.org/technique/d3f:OperatingSystemMonitoring/"
                },
                {
                    "D3FEND": "D3-CI",
                    "URL": "https://d3fend.mitre.org/technique/d3f:ConfigurationInventory/"
                },
                {
                    "D3FEND": "D3-SICA",
                    "URL": "https://d3fend.mitre.org/technique/d3f:SystemInitConfigAnalysis/"
                },
                {
                    "D3FEND": "D3-PH",
                    "URL": "https://d3fend.mitre.org/technique/d3f:PlatformHardening/"
                }
            ]
        },
        {
            "Platform": [
                "macOS"
            ]
        },
        {
            "Group": [
                {
                    "Group": "Non",
                    "URL": "None"
                }
            ]
        },
        {
            "Campaign": []
        },
        {
            "CIS": [
                {
                    "CIS": "CIS 4",
                    "URL": "https://www.cisecurity.org/controls/secure-configuration-of-enterprise-assets-and-software"
                },
                {
                    "CIS": "CIS 2",
                    "URL": "None"
                },
                {
                    "CIS": "CIS 3",
                    "URL": "None"
                },
                {
                    "CIS": "CIS 6",
                    "URL": "None"
                }
            ]
        },
        {
            "Agent": []
        }
    ],
    "Type": "TTP (Tactics, Techniques, and Procedures)",
    "Logging Required": [],
    "Recommended Actions": [],
    "Considerations": [
        "During scheduled system maintenance or updates, legitimate modifications to system registry keys related to monitoring may occur, which could trigger the alert.",
        "When new software is installed, especially those that require system-level access, it may modify registry keys under 'SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors\\', leading to a false positive alert.",
        "Updates to printer drivers or the installation of new printers can modify registry keys in the specified path, which could be misinterpreted as malicious activity."
    ],
    "Mitigation": [
        {
            "Mitigation": "Restrict File and Directory Permissions (M1022)",
            "URL": "https://attack.mitre.org/mitigations/M1022"
        }
    ],
    "References": [
        "MITRE. (n.d.). MITRE ATT&CK. https://attack.mitre.org/",
        "Center for Internet Security (CIS). (n.d.). CISecurity homepage. https://www.cisecurity.org/",
        "MITRE. (n.d.). MITRE D3FEND. https://d3fend.mitre.org/",
        "National Institute of Standards and Technology. (n.d.). Cybersecurity framework. https://www.nist.gov/cyberframework"
    ]
}