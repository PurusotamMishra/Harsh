{
    "Detection Name": "Registry Local Port Monitor",
    "Description": "Investigating Registry Local Port Monitor modification targeting SYSTEM CurrentControlSet Control Print Monitors.",
    "Annotations": [
        {
            "CVE": ""
        },
        {
            "Technique": "T1037-Boot or Logon Initialization Scripts"
        },
        {
            "Sub-Technique": "T1037.002-Boot or Logon Initialization Scripts: Login Hook"
        },
        {
            "Tactic": "Persistence, Privilege Escalation"
        },
        {
            "D3FEND": [
                {
                    "D3FEND": "D3-DF",
                    "URL": "https://d3fend.mitre.org/technique/d3f:DecoyFile/"
                },
                {
                    "D3FEND": "D3-DO",
                    "URL": "https://d3fend.mitre.org/technique/d3f:DecoyObject/"
                },
                {
                    "D3FEND": "D3-DA",
                    "URL": "https://d3fend.mitre.org/technique/d3f:DynamicAnalysis/"
                },
                {
                    "D3FEND": "D3-EFA",
                    "URL": "https://d3fend.mitre.org/technique/d3f:EmulatedFileAnalysis/"
                },
                {
                    "D3FEND": "D3-EAL",
                    "URL": "https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting/"
                },
                {
                    "D3FEND": "D3-EDL",
                    "URL": "https://d3fend.mitre.org/technique/d3f:ExecutableDenylisting/"
                },
                {
                    "D3FEND": "D3-EI",
                    "URL": "https://d3fend.mitre.org/technique/d3f:ExecutionIsolation/"
                },
                {
                    "D3FEND": "D3-FA",
                    "URL": "https://d3fend.mitre.org/technique/d3f:FileAnalysis/"
                },
                {
                    "D3FEND": "D3-FCOA",
                    "URL": "https://d3fend.mitre.org/technique/d3f:FileContentAnalysis/"
                },
                {
                    "D3FEND": "D3-FCR",
                    "URL": "https://d3fend.mitre.org/technique/d3f:FileContentRules/"
                },
                {
                    "D3FEND": "D3-FE",
                    "URL": "https://d3fend.mitre.org/technique/d3f:FileEncryption/"
                },
                {
                    "D3FEND": "D3-FEV",
                    "URL": "https://d3fend.mitre.org/technique/d3f:FileEviction/"
                },
                {
                    "D3FEND": "D3-FH",
                    "URL": "https://d3fend.mitre.org/technique/d3f:FileHashing/"
                },
                {
                    "D3FEND": "D3-FIM",
                    "URL": "https://d3fend.mitre.org/technique/d3f:FileIntegrityMonitoring/"
                },
                {
                    "D3FEND": "D3-FR",
                    "URL": "https://d3fend.mitre.org/technique/d3f:FileRemoval/"
                },
                {
                    "D3FEND": "D3-LFP",
                    "URL": "https://d3fend.mitre.org/technique/d3f:LocalFilePermissions/"
                },
                {
                    "D3FEND": "D3-PH",
                    "URL": "https://d3fend.mitre.org/technique/d3f:PlatformHardening/"
                },
                {
                    "D3FEND": "D3-PM",
                    "URL": "https://d3fend.mitre.org/technique/d3f:PlatformMonitoring/"
                },
                {
                    "D3FEND": "D3-RF",
                    "URL": "https://d3fend.mitre.org/technique/d3f:RestoreFile/"
                },
                {
                    "D3FEND": "D3-RO",
                    "URL": "https://d3fend.mitre.org/technique/d3f:RestoreObject/"
                }
            ]
        },
        {
            "Platform": [
                "macOS"
            ]
        },
        {
            "Group": []
        },
        {
            "Campaign": []
        },
        {
            "Software": []
        },
        {
            "NIST": [
                {
                    "NIST": "PR.DS",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-ds"
                },
                {
                    "NIST": "PR.PS",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-ps"
                },
                {
                    "NIST": "ID.RA",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/id/id-ra"
                },
                {
                    "NIST": "PR.AA",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-aa"
                },
                {
                    "NIST": "DE.CM",
                    "URL": "https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/de-cm"
                }
            ]
        },
        {
            "CIS": [
                {
                    "CIS": "CIS 5",
                    "URL": "https://www.cisecurity.org/controls/account-management"
                },
                {
                    "CIS": "CIS 4",
                    "URL": "https://www.cisecurity.org/controls/secure-configuration-of-enterprise-assets-and-software"
                }
            ]
        },
        {
            "Agent": []
        }
    ],
    "Type": "TTP (Tactics, Techniques, and Procedures)",
    "Logging Required": [],
    "Recommended Actions": [],
    "Considerations": [
        "During system updates or patches, legitimate modifications to the registry keys related to port monitors might occur. These changes are typically benign and part of the update process.",
        "When new printer drivers are installed or existing ones are updated, the registry keys under 'SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors' may be modified. This is a normal operation and not necessarily indicative of malicious activity.",
        "Administrators might make changes to the registry settings for troubleshooting or configuration purposes. These changes can trigger alerts but are usually legitimate and part of regular administrative tasks."
    ],
    "Mitigation": [
        {
            "Mitigation": "Restrict File and Directory Permissions (M1022)",
            "URL": "https://attack.mitre.org/mitigations/M1022"
        }
    ],
    "References": [
        "MITRE. (n.d.). MITRE ATT&CK. https://attack.mitre.org/",
        "Center for Internet Security (CIS). (n.d.). CISecurity homepage. https://www.cisecurity.org/",
        "MITRE. (n.d.). MITRE D3FEND. https://d3fend.mitre.org/",
        "National Institute of Standards and Technology. (n.d.). Cybersecurity framework. https://www.nist.gov/cyberframework"
    ]
}